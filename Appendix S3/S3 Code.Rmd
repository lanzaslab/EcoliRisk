---
title: "pairedSurvivalTesting"
author: "Trevor Farthing"
date: "6/14/2020"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## Load and process survival data

This data set describes when steer in field transmission trials were shedding *Escherichia coli*. Two trials took place. One in summer 2017, and another in summer 2018. For each trial, 70 steer were brought into a feedlot pen, and 5 were inoculated with an identifiable strain of *E. coli*. Every week, fecal samples were collected from each individual and tested to see if they were actively shedding the *E. coli*. See the main article text for more details.

We're interested in assessing the risk of *E. coli* colonization in feedlot cattle, given an active E. coli outbreak, and analyzing drivers of transmission.

The data set we refer to as "eColiShedding.csv" contains the sampling data from the trials described above. There are 1120 observations within this set. Columns are described below:

year: Year that the study took place (i.e., 2017 or 2018)
calf_id: Unique ids for calves within the study
REDI_id: Tags used to identify calves during the study (note that REDI tags were often reused for multiple individuals across different years)
innoc_date: Date that certain calves were innoculated. If NA, individuals were not innoculated with *E. coli*, and any observed *E. coli* colonization was the result of successful transmission.
Week: Unique Integer week ID within the given year that the sample was collected.
sampling_date: Date of sample collection.
shedding_fecal: Binary. If "1", individuals tested positive for fecal *E. coli* in a given week. If "0", they tested negative.
CFU: The log number of Colony-Forming-Units sampled from individuals in a given week.

```{r load data}

#Load external libraries
library(contact) #version 1.2.5
library(corrplot) #version 0.84
library(data.table) #version 1.12.8
library(foreach) #version 1.5.0
library(lubridate) #version 1.7.9
library(survminer) #version 0.4.8
library(survival) #version 3.2-7
library(transtat) #version 0.3.3

calf_transmission.raw <- read.csv("eColiShedding.csv") #pull in the multi-year transmission data 

#remove observations where individuals have an unknown shedding status 
calf_transmission.updated <- droplevels(calf_transmission.raw[-which(is.na(calf_transmission.raw$shedding_fecal) == TRUE),])

#order the data appropriately
calf_transmission.updated<- calf_transmission.updated[order(calf_transmission.updated$year, calf_transmission.updated$Week, calf_transmission.updated$calf_id),]
rownames(calf_transmission.updated) <- seq(1, nrow(calf_transmission.updated))

#Now we're going to break this down by year and arrange the columns into a form that allows for pairwise accelerated-failure-time modeling (Sharker & Kenah 2019)

calf_transmission.updated$previousInfection <- 0 #we define this variable for each calf_id to determine if individuals are susceptible. Once an individual has been infected once, they are removed from the list of susceptibles.
#we update the previousInfection column with the loop below
for(i in unique(calf_transmission.updated$calf_id)) {
  
  calfInfectedRows <- which(calf_transmission.updated$calf_id == i & calf_transmission.updated$shedding_fecal == 1)  #identify which rows contain data about when a calf id shedding
  
  if(length(calfInfectedRows) == 0){ # if a calf was never infected the loop moves on
    
    next
    
  }
  
  calfAllRows <- which(calf_transmission.updated$calf_id == i) #identify ALL rows associated with each ID
  calfInfectedRows <- calfAllRows[which(calfAllRows > min(calfInfectedRows))] #identify all weeks AFTER calves were infected (Note that this only works because the data set is ordered by week). Weeks that calves were first reported to be infected remain as 0.
  
  if(length(calfInfectedRows) == 0){ #if there are no entries here, the list moves on.
    
    next
    
  }
  
  calf_transmission.updated$previousInfection[calfInfectedRows] <- 1 #update the values in this column
  
}

#we add 52 to the week ids in 2018 (because they currently have the same IDs as those for 2017)
calf_transmission.updated$Week[which(calf_transmission.updated$year == 2018)] <- calf_transmission.updated$Week[which(calf_transmission.updated$year == 2018)] +52

#we make year into a binary variable - which appears to be a requirement of variables used by the AFT modeling procedure.
calf_transmission.updated$year_2017 <- ifelse(calf_transmission.updated$year == 2017, 1, 0)

#now we define the start and end time (in days) for each time period
calf_transmission.updated$start <- calf_transmission.updated$Week - 1  # week 1 starts on day 1 and ends at day 7. Week 2 starts on day 8 and ends at day 14. Etc.
calf_transmission.updated$stop <- calf_transmission.updated$Week # week 1 starts on day 1 and ends at day 7. Week 2 starts on day 8 and ends at day 14. Etc.

#Add week 0 and week 52 data to the data set (weeks when only the innoculated calves were infectious).
innoc_2017 <- unique(calf_transmission.updated[which(calf_transmission.updated$year == 2017 & is.na(calf_transmission.updated$innoc_date) == FALSE), match("calf_id", colnames(calf_transmission.updated))])
innoc_2018 <- unique(calf_transmission.updated[which(calf_transmission.updated$year == 2018 & is.na(calf_transmission.updated$innoc_date) == FALSE), match("calf_id", colnames(calf_transmission.updated))])
innoc_frame <- data.frame(
  
  year = c(rep(2017, 5), rep(2018, 5)), 
  calf_id = c(innoc_2017, innoc_2018),
  REDI_id = NA, #no need to import the REDI IDs
  innoc_date = c(rep("05-22-2017",5), rep("05-21-2018", 5)),
  Week = c(rep(0, 5), rep(52, 5)),
  sampling_date = NA, #no need to import
  shedding_fecal = 1,
  #CFU = NA, #no need to import
  CFU = c(mean(c(2.6,0.7,0,0.7)), mean(c(0.7,	0,	0.7,	0.7)), mean(c(0.7,	0.7,	0,	2.95)), mean(c(0.7,	0.7,	0,	0.7)), mean(c(0,	0.7,	0,	0.7)), mean(c(0.7,	0.7,	0.7,	0.7)), mean(c(0.7,	0.7,	0.7,	0.7)), mean(c(0.7,	0.7,	0.7,	0.7)), mean(c(0.7,	0.7,	0.7,	0.7)), mean(c(0.7,	0.7,	0.7,	0.7))), # CFU values here represent the mean log CFU counts over the 2nd-5th days post innoculation
  nodeType = "calf",
  previousInfection = NA, #no need to import
  year_2017 = c(rep(1, 5), rep(0,5)),
  start = NA, #no need to import
  stop = NA #no need to import
)

calf_transmission.updated <- data.frame(data.table::rbindlist(list(innoc_frame, calf_transmission.updated))) #bind the data together

```

## Generate paired infection data

Here we create a dataset describing what susceptible-infectious pairs exist each week. For each week "susceptible" individuals are ones that did not have any positive fecal sample(s) in previous weeks, and "infectious" individuals are the ones actively shedding or that were shedding one week prior. Once an individual is observed to have a positive fecal sample, they are removed from the list of susceptibles moving forward (e.g., if an individual is found to be shedding *E. coli* in week 2, they are not considered susceptible in weeks 3, 4, 5, etc.).

This is NOT the ultimate data set we plan to use for analysis, but it will serve as the base of that set. Later we append covariates of interest to this set for analysis.

The following columns exist in the data frames:

id_sus: Unique ID of the susceptible individual of the pair.
start: Start time (i.e., id of the preceding week/sampling time).
stop: End time (i.e., id of the current week/sampling time).
week: Unique week ID.
shedding: Binary variable describing if individuals' fecal samples were positive.
year_2017: Binary variable describing if the trial year was 2017.
id_inf: Unique ID of the infectious individual/trough
environmentalExposureNum: Count of the number of individuals (i.e., calves) shedding E. coli during the time period.

```{r paired data}
#now we pull susceptible individuals at each time point.
susceptible_times <- droplevels(calf_transmission.updated[which(is.na(calf_transmission.updated$innoc_date) == TRUE & calf_transmission.updated$previousInfection == 0),]) #pull observations of calves that were susceptible going into the week. (i.e., calves that were not innoculated and DID NOT test positive any previous weeks)

#now we pull the individuals that can infect others
infectious_times <- droplevels(subset(calf_transmission.updated, shedding_fecal == 1))

#now we make the pairwise shedding risk data frame

#all infectious calves are included as potential infectors.

  pairedFrame_weekList <- foreach::foreach(j = unique(susceptible_times$Week)) %do% { #for every week represented in the susceptible set, we create a list of individuals that can infect them at that time, and build a data frame detailing pairwise person-times (i.e., calf-times)
  
  susceptible_week <- droplevels(subset(susceptible_times, Week == j)) #subset by week
    
  infectious_week <- droplevels(subset(infectious_times, Week == j | Week == (j - 1))) #subset by week. 
  
  if(length(which(duplicated(infectious_week$calf_id) == TRUE)) > 0){ #remove any duplicates
    
    infectious_week <- droplevels(infectious_week[which(duplicated(infectious_week$calf_id) == FALSE),])
    
  }
  
  infectiousDyadFrame <- NULL #Create empty data frames in case there were no infectious individuals
  
  if(nrow(infectious_week) > 0){
    
    for(k in 1:nrow(susceptible_week)){
      
      dyad_time <- NULL #create an empty data frame that we will bind to
      
      for(l in 1:nrow(infectious_week)){ #we loop through the rows in infectious_week to create pairwise persontime observations
        
dyad <- data.frame(
  id_sus = as.character(susceptible_week$calf_id)[k], #id of the susceptible
  start = susceptible_week$start[k], #start of observation period
  stop = susceptible_week$stop[k], #end of observation period
  week = susceptible_week$Week[k], #week ID
  shedding = susceptible_week$shedding_fecal[k], #if the susceptible individual was observed shedding (i.e., failing)
  year_2017 = susceptible_week$year_2017[k], #binary year variable
  id_inf = as.character(infectious_week$calf_id)[l], # id of the infectious individual
  infectiousNum.week = ifelse(susceptible_week$shedding_fecal[k] == 1, nrow(infectious_week) - 1, nrow(infectious_week)) #count of infectious individuals in the contact interval (minus 1 if the susceptible here was shedding)
)
  dyad_time <- data.frame(data.table::rbindlist(list(dyad_time, dyad))) #bind these data together
      }
     
      infectiousDyadFrame <- data.frame(data.table::rbindlist(list(infectiousDyadFrame, dyad_time))) #bind these data together
     
    }
  }
  
  if(is.null(infectiousDyadFrame) == FALSE){
    infectiousDyadFrame <- infectiousDyadFrame[order(infectiousDyadFrame$id_sus, infectiousDyadFrame$id_inf),] #order appropriately
  }
  
  return(infectiousDyadFrame)
  
}

pairedFrame <- data.frame(data.table::rbindlist(pairedFrame_weekList)) #bind the weeklist into a single data frame.
if(length(which(as.character(pairedFrame$id_sus) == as.character(pairedFrame$id_inf))) > 0){ #remove instances when susceptibles have a chance to infect themselves (if it exists, which it shouldn't given how we previously subset the data).
  pairedFrame <- droplevels(pairedFrame[-which(as.character(pairedFrame$id_sus) == as.character(pairedFrame$id_inf)),]) #remove instances when susceptibles have a chance to infect themselves.
}
pairedFrame$id_sus <- as.integer(as.character(pairedFrame$id_sus)) #it seems like the susceptible ID must be numeric for later analysis using the transtat package.

```

Note that while individuals were technically monitored for 6 weeks and 10 weeks in 2017 and 2018, respectively, because we define infectious individuals as those that were observed shedding in the current and/or previous week, we can only use our intended pairwise procedure to model failure prior to the first week each year when there were 0 shedding individuals observed for two consecutive weeks. This occurred in week 6 of 2017, and did not occur in 2018. Luckily no observed susceptibles failed in the final week of observation in 2017, so censuring animals a week early is reasonable, if not ideal.

##Add dyad-level covariates

We created a data frame describing observed contacts and social relationships between nodes in Appendix S2 (i.e., "AFTCovariates.RData"). Here we load this data frame and merge it to the paired survival data set.

```{r dyad-level metrics}
load("AFTCovariates.RData") #load covariateFrame

colnames(covariateFrame)[match("block", colnames(covariateFrame))] <- "week" #change the name of the "block" column in covariateFrame to "week" to match the column name in pairedFrame

pairedFrame$dyadID <- paste(pairedFrame$id_sus, pairedFrame$id_inf, sep = "-") #create a merge key in the paired data set. Note that this makes susceptible individuals the from node, and infectious individuals the to node.

pairedFrame.merge <- merge(x = pairedFrame, y = covariateFrame, by = c("dyadID", "week"), all.x = TRUE) #merge the data sets

```

##Fix NAs

In 2018 there were 4 individuals (i.e., 1525, 1580, 1587, and 1709) who were not observed in contact with anyone else for weeks at a time, and RTLS point locations are generally very sparse relative to what was observd in 2017 (*see* Appendix S1). This is likely due to faulty RTLS tags and/or damaged receivers/wires. Because no contact/social information could be calculated for these individuals during these weeks, there are NAs introduced in the merged paired data set. Here, we replace NAs with 0s. Note that we are introducing 0s rather than removing survival data for two reasons: 1.) Despite the fact that animals were unobserved in the RTLS system at times, they still undoubtedly played a role in transmission. 2.) Contact and social metrics are based on observed contacts, rather than true real-world contacts (which we cannot confirm). In these time blocks we observed 0 contacts between these individuals and others, therefore inclusion of 0s here is appropriate. However, because RTLS information content varied so drastically between years, metrics based on RTLS data collected in 2018 are likely quite biased relative to 2017 metrics. This means that infection risk over the two years must be evaluated separately.

```{r fix.nas}

pairedFrame.merge$social[which(is.na(pairedFrame.merge$social) == TRUE)] <- 0 #we will use this variable to account for social relationships. Here, we replace NAs with 0. 
pairedFrame.merge$contacts.avg[which(is.na(pairedFrame.merge$contacts.avg) == TRUE)] <- 0 #we will use this variable to account for social relationships. Here, we replace NAs with 0.
pairedFrame.merge$socialDeg.from[which(is.na(pairedFrame.merge$socialDeg.from) == TRUE)] <- 0 #This variable describes the number of social relationships observed for susceptible individuals each week - or what we like to refer to as their "popularity" metric. Here, we replace NAs with 0.
pairedFrame.merge$socialDeg.to[which(is.na(pairedFrame.merge$socialDeg.to) == TRUE)] <- 0 #This variable describes the number of social relationships observed for susceptible individuals each week - or what we like to refer to as their "popularity" metric. Here, we replace NAs with 0.

```

##Add environmental covariates

Weather data were downloaded from the National Oceanic and Atmospheric Administration' National Centers for Environmental Information (https://www.ncdc.noaa.gov/cdo-web/). The data set details daily precipitation (in cm) between 05/21/2017 and 08/31/2018 in Manhattan KS, where animals were housed. We refer to this data set as "noaaData2017&2018.csv." Note that technically there are other weather variables included in the data set, but they are incredibly sparse and will not be included in subsequent analyses.

We also load environmental sampling data describing the number of positive and negative samples collected from the pen, food trough, and water trough each week, which we refer to as "multiYearEnvrSampleCount.csv." 

```{r weather}

precip<- read.csv("noaaData2017&2018.csv")

precip$year <- lubridate::year(as.character(precip$DATE)) #append year information
precip<- droplevels(precip[which(lubridate::as_datetime(as.character(precip$DATE)) >= "2017-05-22"),]) #ensure start date is the same as that in the 2017 study.
precip.blocks<-contact::timeBlock.append(x = NULL, dateTime = lubridate::as_datetime(as.character(precip$DATE)), blockLength = 1, blockUnit = "weeks", blockingStartTime = "2017-05-22") #block the precipitation data beginning with the first day of the 2017 study.
precip$week <- precip.blocks$block #add the block data to a "week" column in the precip
precip.agg <- aggregate(PRCP~week, data = precip, FUN = "mean") #report the average daily amount of rain observed each week

pairedFrame.merge <- merge(x = pairedFrame.merge, y = precip.agg, by = "week", all.x = TRUE) #merge the mean daily precipitation data to the survival data set.

envrSamples<- read.csv("multiYearEnvrSampleCount.csv")

#envrSamples$pen_pos.prev <- c(0, envrSamples$pen_pos[1:(nrow(envrSamples)-1)]) #ensure the environmental sample covariate is on the same temporal scale as the fecal samples

envrSamples$pen_pos.prev <- c(NA, envrSamples$pen_pos[1:6], NA, envrSamples$pen_pos[8:(nrow(envrSamples)-1)]) #ensure the environmental sample covariate is on the same temporal scale as the fecal samples

envrSamples$pen_pos.avg <- (envrSamples$pen_pos + envrSamples$pen_pos.prev)/2
envrSamples$pen_pos.avg[c(1,8)] <- envrSamples$pen_pos[c(1,8)] #replace NAs when there was only one sampling period with the value of that one period

envrSamples$week[which(envrSamples$year == 2018)] <- envrSamples$week[which(envrSamples$year == 2018)] + 52 #add 52 to facilitate merging

envrSamples$pen_pos.percent <- envrSamples$pen_pos/(envrSamples$pen_pos + envrSamples$pen_neg) #convert the total samples observed to the perccent of total samples taken each week

pairedFrame.merge <- merge(x = pairedFrame.merge, y = envrSamples, by = "week", all.x = TRUE) #merge the mean daily precipitation data to the survival data set.

```

#Reset 2018 start/stop times 

Because we will be modeling the two years separately, we need to ensure that 2018 epidemics start at time 0 as well. I know this might seem a bit strange because we added 52 to 2018 start/stop times above and now we're removing it. Adding it above just made merging covariate data frames with the survival data much easier.

Below, we also take the opportunity to plot model covariates.

```{r updateTimes}

pairedFrame.merge$start[which(pairedFrame.merge$year_2017 == 0)] <- pairedFrame.merge$start[which(pairedFrame.merge$year_2017 == 0)] - 52 #subtract 52 weeks from start times in 2018
pairedFrame.merge$stop[which(pairedFrame.merge$year_2017 == 0)] <- pairedFrame.merge$stop[which(pairedFrame.merge$year_2017 == 0)] - 52 #subtract 52 weeks from stop times in 2018

pairedFrame.merge$year <- as.character(pairedFrame.merge$year)
#now let's plot covariates

rainAgg <- aggregate(PRCP~ stop + year, data = pairedFrame.merge, FUN = "mean") #report mean avg daily rainfall by week and year (note FUN == "mean", but all intra-week values will be the same for this covariate)

ggplot(rainAgg, aes(x= stop, y=PRCP, fill = year, col = year)) + 
  geom_point(cex = 4, position = position_dodge(width=0.07)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", cex = 1.8) +
  ggtitle("Linear trends in mean daily precipitation per week") +
  scale_y_continuous(name = "Precipitation (cm)") +
  scale_x_continuous(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

envr.total <- aggregate(pen_pos.avg~ stop + year, data = pairedFrame.merge, FUN = "mean") #report mean positive pen samples by week and year (note FUN == "mean", but all intra-week values will be the same for this covariate)

ggplot(envr.total, aes(x= stop, y=pen_pos.avg, fill = year, col = year)) + 
  geom_point(cex = 4, position = position_dodge(width=0.07)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", cex = 1.8) +
  ggtitle( "Linear trends in mean daily positive soil sample  per week")   +
  scale_y_continuous(name = "Mean positive soil samples") +
  scale_x_continuous(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

shedAgg.week <- aggregate(infectiousNum.week~ stop + year, data = pairedFrame.merge, FUN = "max") #report mean weekly confirmed shedding events by week and year (note FUN == "mean", but all intra-week values will be the same for this covariate)

ggplot(shedAgg.week, aes(x= stop, y=infectiousNum.week, fill = year, col = year)) + 
  geom_point(cex = 4, position = position_dodge(width=0.07)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", cex = 1.8) +
  scale_y_continuous(name = "Number infectious") +
  scale_x_continuous(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

pairedFrame.merge$week.factor <- factor(pairedFrame.merge$stop, levels = c("1","2","3","4","5","6","7","8","9","10"))

ggplot(pairedFrame.merge, aes(week.factor, y=contacts.avg, fill = year)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", aes(x=stop, y=contacts.avg, col = year), cex = 1.8) +
  geom_boxplot()+
  scale_x_discrete(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  scale_y_continuous(name = "Per-capita mean daily ij contacts") +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

socAgg1 <- aggregate(social ~ stop + week.factor + year + id_sus, data = pairedFrame.merge, FUN = "sum") #sum social contacts for susceptible individuals each week

ggplot(socAgg1, aes(x= week.factor, y=social, fill = year)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", aes(x=stop, y=social, col = year), cex = 1.8) +
  geom_boxplot()+
  scale_x_discrete(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  scale_y_continuous(name = "Per-capita ij social relationships") +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

socDegreeAgg <- aggregate(socialDeg.from ~ stop + week.factor + year + id_sus, data = pairedFrame.merge, FUN = "mean") #mean social degree of susceptible individuals by week and year (note FUN == "mean", but all per-capita intra-week values will be the same for this covariate. We're just removing unnecessary rows from the data)

ggplot(socDegreeAgg, aes(x= week.factor, y=socialDeg.from, fill = year)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", aes(x=stop, y=socialDeg.from, col = year), cex = 1.8) +
  geom_boxplot()+
  scale_x_discrete(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  scale_y_continuous(name = "Per-capita social degree for j nodes") +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

socDegreeAgg2 <- aggregate(socialDeg.to ~ stop + week.factor + year + id_inf, data = pairedFrame.merge, FUN = "mean") #mean social degree of infectious individuals by week and year (note FUN == "mean", but all per-capita intra-week values will be the same for this covariate. We're just removing unnecessary rows from the data)

ggplot(socDegreeAgg2, aes(x= week.factor, y=socialDeg.to, fill = year)) + 
  geom_smooth(method=lm, se=FALSE, fullrange=FALSE, formula = "y ~ x", aes(x=stop, y=socialDeg.to, col = year), cex = 1.8) +
  geom_boxplot()+
  scale_x_discrete(name = "Time (weeks)", breaks = c(1,2,3,4,5,6,7,8,9,10)) +
  scale_y_continuous(name = "Per-capita social degree for i nodes") +
  theme_classic2() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 0),
    legend.spacing.x = unit(0.3, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 10, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 10, b = 0, l = 0)),
    text = element_text(size = 15)
  )

correlationFrame_2017 <- data.frame(week = pairedFrame.merge$stop[which(pairedFrame.merge$year == 2017)],  precip  = pairedFrame.merge$PRCP[which(pairedFrame.merge$year == 2017)], penSample = pairedFrame.merge$pen_pos.avg[which(pairedFrame.merge$year == 2017)], I.j = pairedFrame.merge$infectiousNum.week[which(pairedFrame.merge$year == 2017)], contacts = pairedFrame.merge$contacts.avg[which(pairedFrame.merge$year == 2017)], social = pairedFrame.merge$social[which(pairedFrame.merge$year == 2017)], degree.i = pairedFrame.merge$socialDeg.to[which(pairedFrame.merge$year == 2017)], degree.j = pairedFrame.merge$socialDeg.from[which(pairedFrame.merge$year == 2017)])
correlationFrame_2018 <- data.frame(week = pairedFrame.merge$stop[which(pairedFrame.merge$year == 2018)],  precip  = pairedFrame.merge$PRCP[which(pairedFrame.merge$year == 2018)], penSample = pairedFrame.merge$pen_pos.avg[which(pairedFrame.merge$year == 2018)], I.j = pairedFrame.merge$infectiousNum.week[which(pairedFrame.merge$year == 2018)], contacts = pairedFrame.merge$contacts.avg[which(pairedFrame.merge$year == 2018)], social = pairedFrame.merge$social[which(pairedFrame.merge$year == 2018)], degree.i = pairedFrame.merge$socialDeg.to[which(pairedFrame.merge$year == 2018)], degree.j = pairedFrame.merge$socialDeg.from[which(pairedFrame.merge$year == 2018)])

correlationMat_2017 <- cor(correlationFrame_2017)
correlationMat_2018 <- cor(correlationFrame_2018)
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA")) #redefine color palette
corrplot::corrplot(correlationMat_2017, method="color", col= col(20), type="lower", cl.length = 5, addCoef.col = "black", tl.col="black", tl.srt=50, tl.cex = 0.9, tl.offset = 1.3, number.cex = 0.7, diag=TRUE) #plot the correlation matrix.
corrplot::corrplot(correlationMat_2018, method="color", col= col(20), type="lower", cl.length = 5, addCoef.col = "black", tl.col="black", tl.srt=50, tl.cex = 0.9, tl.offset = 1.3, number.cex = 0.7, diag=TRUE) #plot the correlation matrix.


```

##Paired AFT modeling

Below we use the "transreg" function from the transtat package (v. 0.3.3, available at https://github.com/ekenah/transtat) to employ the parametric pairwise accelerated failure time modeling procedure described by Sharker & Kenah (2019) & Kenah (2019) to evaluate the effects of select covariates on weekly hazard rates. We fit our paired survival data to Weibull models. We create a model fit to a Weibull distribution for each potential covariate combination of interest, then use AIC-based procedures to select the "best-fitting" model(s). We maintain that "best-fitting" model each year is the one with the greatest AIC weights (Anderson 2008). As noted above, due to differences in location data quality between 2017 and 2018 study periods, we model hazard in each year separately. Our full model contains interaction terms between environmental variables, and between dyad/individual-level variables. 

We'll spare you the details of the code for the chunk below by setting echo = FALSE, because running all 626 models took up about 9,000 lines of code.... If you want to recreate the model runs, you can take the variable inputs from the produced AIC data frame. Note that popularity_inf and popularity_sus refer to the socialDeg.to and socialDeg.from columns in the data set, respectively. Below is an example showing how to run a couple models using the transtat::transreg function.

Example::

ex1<-transtat::transreg(
  formula = Surv(start, stop, shedding) ~ 1, #NULL
  sus = "id_sus",
  data = droplevels(subset(pairedFrame.merge, year_2017 == 1)), #only including 2017 data
  dist = "weibull",
  xdist = NULL,
  optim_method = "Nelder-Mead"
)

ex2<-transtat::transreg(
  formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg,
  sus = "id_sus",
  data = droplevels(subset(pairedFrame.merge, year_2017 == 1)), #only including 2017 data
  dist = "weibull",
  xdist = NULL,
  optim_method = "Nelder-Mead"
)


```{r survival, echo=FALSE, warning= FALSE}

#Generate empty vectors that will be appended with values after each model is created. These vectors will be compiled into a single data frame later on for easy sorting.

model.vec <- NULL #describes what covariates are included
aic.vec <- NULL #describes model aic
distribution.vec <- NULL #describes the distribution the data were fit to
year.vec <- NULL #describes the year the data were collected
lik.vec <- NULL #describes model log-likelihood
lambda.vec <- NULL #describes the mean per-capita lambda (i.e., force of infection) from infectious individuals in in a given year according to the model
lambda.init.vec <- NULL #describes the mean per-capita lambda (i.e., force of infection) from only initially-infected individuals in in a given year according to the model
lambda.week <- NULL #describes the mean per-capita lambda (i.e., force of infection) from infectious individuals in in a given year according to the model, aggregated by week.

lambdaEst <- function(x, model){ #calculate the mean per-capita lambda (i.e., force of infection) from infectious individuals in x
  
  covariates <- model$coefficients #pull the covariates included in the model
  x$lambda <- covariates["(Intercept)"] #add the intercept value to driving infection force rate (i.e., lambda)
  
  #now we add to the lambda values depending on what covariates were included in the model.
  
  if (length(which(names(covariates) == "pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg covariate, we add the product of the coefficient and pen_pos.avg values to lambda.
    
    x$lambda <- x$lambda + (x$pen_pos.avg * covariates["pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg values to lambda.
    
  }
  
  if (length(which(names(covariates) == "infectiousNum.week")) >= 1){ # if the model includes the infectiousNum.week covariate, we add the product of the coefficient and infectiousNum.week values to lambda.
    
    x$lambda <- x$lambda + (x$infectiousNum.week * covariates["infectiousNum.week"]) #add the product of the coefficient and infectiousNum.week values to lambda.
    
  }
  
  if (length(which(names(covariates) == "PRCP")) >= 1){ # if the model includes the PRCP covariate, we add the product of the coefficient and PRCP values to lambda.
    
    x$lambda <- x$lambda + (x$PRCP * covariates["PRCP"]) #add the product of the coefficient and PRCP values to lambda.
    
  }
  
  if (length(which(names(covariates) == "contacts.avg")) >= 1){ # if the model includes the contacts.avg covariate, we add the product of the coefficient and contacts.avg values to lambda.
    
    x$lambda <- x$lambda + (x$contacts.avg * covariates["contacts.avg"]) #add the product of the coefficient and contacts.avg values to lambda.
    
  }
  
  if (length(which(names(covariates) == "social")) >= 1){ # if the model includes the social covariate, we add the product of the coefficient and social values to lambda.
    
    x$lambda <- x$lambda + (x$social * covariates["social"]) #add the product of the coefficient and social values to lambda.
    
  }
  
  if (length(which(names(covariates) == "socialDeg.to")) >= 1){ # if the model includes the socialDeg.to covariate, we add the product of the coefficient and socialDeg.to values to lambda.
    
    x$lambda <- x$lambda + (x$socialDeg.to * covariates["socialDeg.to"]) #add the product of the coefficient and socialDeg.to values to lambda.
    
  }
  
  if (length(which(names(covariates) == "socialDeg.from")) >= 1){ # if the model includes the socialDeg.from covariate, we add the product of the coefficient and socialDeg.from values to lambda.
    
    x$lambda <- x$lambda + (x$socialDeg.from * covariates["socialDeg.from"]) #add the product of the coefficient and socialDeg.from values to lambda.
    
  }
  
  #now we add the interaction term effects
  
  if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week")) >= 1 | length(which(names(covariates) == "infectiousNum.week:pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg:infectiousNum.week covariate, we add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    
    if(length(which(names(covariates) == "pen_pos.avg:infectiousNum.week")) >= 1){
       x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    if(length(which(names(covariates) == "infectiousNum.week:pen_pos.avg")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
  }
  
  if (length(which(names(covariates) == "pen_pos.avg:PRCP")) >= 1 | length(which(names(covariates) == "PRCP:pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg:PRCP covariate, we add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    
    if (length(which(names(covariates) == "pen_pos.avg:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$PRCP * covariates["pen_pos.avg:PRCP"]) #add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    }
    if (length(which(names(covariates) == "PRCP:pen_pos.avg")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$PRCP * covariates["PRCP:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    }
    
  }
  
  if (length(which(names(covariates) == "infectiousNum.week:PRCP")) >= 1 | length(which(names(covariates) == "PRCP:infectiousNum.week")) >= 1){ # if the model includes the infectiousNum.week:PRCP covariate, we add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    
    if (length(which(names(covariates) == "infectiousNum.week:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$infectiousNum.week * x$PRCP * covariates["infectiousNum.week:PRCP"]) #add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    }
    if (length(which(names(covariates) == "PRCP:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$infectiousNum.week * x$PRCP * covariates["PRCP:infectiousNum.week"]) #add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    }
    
  }
  
  if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week:PRCP")) >= 1 | length(which(names(covariates) == "infectiousNum.week:pen_pos.avg:PRCP")) >= 1 | length(which(names(covariates) == "pen_pos.avg:PRCP:infectiousNum.week")) >= 1 | length(which(names(covariates) == "infectiousNum.week:PRCP:pen_pos.avg")) >= 1 | length(which(names(covariates) == "PRCP:infectiousNum.week:pen_pos.avg")) >= 1 | length(which(names(covariates) == "PRCP:pen-pos.avg:infectiousNum.week")) >= 1){ # if the model includes the pen_pos.avg:infectiousNum.week covariate, we add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    
    if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:infectiousNum.week:PRCP"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "infectiousNum.week:pen_pos.avg:PRCP")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:pen_pos.avg:PRCP"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
    if (length(which(names(covariates) == "pen_pos.avg:PRCP:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:PRCP:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "infectiousNum.week:PRCP:pen_pos.avg")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:PRCP:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
    if (length(which(names(covariates) == "PRCP:pen_pos.avg:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["PRCP:pen_pos.avg:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "PRCP:infectiousNum.week:pen_pos.avg")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["PRCP:infectiousNum.week:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
  }
  
  if (length(which(names(covariates) == "contacts.avg:social")) >= 1 | length(which(names(covariates) == "social:contacts.avg")) >= 1){ # if the model includes the contacts.avg:social covariate, we add the product of the coefficient and contacts.avg:social values to lambda.
    
    if (length(which(names(covariates) == "contacts.avg:social")) >= 1){
      x$lambda <- x$lambda + (x$contacts.avg * x$social * covariates["contacts.avg:social"]) #add the product of the coefficient and contacts.avg:social values to lambda.
    }
    if (length(which(names(covariates) == "social:contacts.avg")) >= 1){
      x$lambda <- x$lambda + (x$contacts.avg * x$social * covariates["social:contacts.avg"]) #add the product of the coefficient and contacts.avg:social values to lambda.
    }
    
  }
  
  x$lambda <- exp(x$lambda) #finally, we exponentiate as we should
  
  lambda.avg <- mean(x$lambda) #calculate the average lambda
  return(lambda.avg)
  
}

lambdaEst.init <- function(x, model, innocCalves){ #calculate the mean per-capita lambda (i.e., force of infection) from only initially infected calves in x 
  
  x$count. <-1 #add a column to be summed later
  
  covariates <- model$coefficients #pull the covariates included in the model
  x$lambda <- covariates["(Intercept)"] #add the intercept value to driving infection force rate (i.e., lambda)
  
  #now we add to the lambda values depending on what covariates were included in the model.
  
  if (length(which(names(covariates) == "pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg covariate, we add the product of the coefficient and pen_pos.avg values to lambda.
    
    x$lambda <- x$lambda + (x$pen_pos.avg * covariates["pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg values to lambda.
    
  }
  
  if (length(which(names(covariates) == "infectiousNum.week")) >= 1){ # if the model includes the infectiousNum.week covariate, we add the product of the coefficient and infectiousNum.week values to lambda.
    
    x$lambda <- x$lambda + (x$infectiousNum.week * covariates["infectiousNum.week"]) #add the product of the coefficient and infectiousNum.week values to lambda.
    
  }
  
  if (length(which(names(covariates) == "PRCP")) >= 1){ # if the model includes the PRCP covariate, we add the product of the coefficient and PRCP values to lambda.
    
    x$lambda <- x$lambda + (x$PRCP * covariates["PRCP"]) #add the product of the coefficient and PRCP values to lambda.
    
  }
  
  if (length(which(names(covariates) == "contacts.avg")) >= 1){ # if the model includes the contacts.avg covariate, we add the product of the coefficient and contacts.avg values to lambda.
    
    x$lambda <- x$lambda + (x$contacts.avg * covariates["contacts.avg"]) #add the product of the coefficient and contacts.avg values to lambda.
    
  }
  
  if (length(which(names(covariates) == "social")) >= 1){ # if the model includes the social covariate, we add the product of the coefficient and social values to lambda.
    
    x$lambda <- x$lambda + (x$social * covariates["social"]) #add the product of the coefficient and social values to lambda.
    
  }
  
  if (length(which(names(covariates) == "socialDeg.to")) >= 1){ # if the model includes the socialDeg.to covariate, we add the product of the coefficient and socialDeg.to values to lambda.
    
    x$lambda <- x$lambda + (x$socialDeg.to * covariates["socialDeg.to"]) #add the product of the coefficient and socialDeg.to values to lambda.
    
  }
  
  if (length(which(names(covariates) == "socialDeg.from")) >= 1){ # if the model includes the socialDeg.from covariate, we add the product of the coefficient and socialDeg.from values to lambda.
    
    x$lambda <- x$lambda + (x$socialDeg.from * covariates["socialDeg.from"]) #add the product of the coefficient and socialDeg.from values to lambda.
    
  }
  
  #now we add the interaction term effects
  
  if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week")) >= 1 | length(which(names(covariates) == "infectiousNum.week:pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg:infectiousNum.week covariate, we add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    
    if(length(which(names(covariates) == "pen_pos.avg:infectiousNum.week")) >= 1){
       x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    if(length(which(names(covariates) == "infectiousNum.week:pen_pos.avg")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
  }
  
  if (length(which(names(covariates) == "pen_pos.avg:PRCP")) >= 1 | length(which(names(covariates) == "PRCP:pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg:PRCP covariate, we add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    
    if (length(which(names(covariates) == "pen_pos.avg:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$PRCP * covariates["pen_pos.avg:PRCP"]) #add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    }
    if (length(which(names(covariates) == "PRCP:pen_pos.avg")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$PRCP * covariates["PRCP:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    }
    
  }
  
  if (length(which(names(covariates) == "infectiousNum.week:PRCP")) >= 1 | length(which(names(covariates) == "PRCP:infectiousNum.week")) >= 1){ # if the model includes the infectiousNum.week:PRCP covariate, we add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    
    if (length(which(names(covariates) == "infectiousNum.week:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$infectiousNum.week * x$PRCP * covariates["infectiousNum.week:PRCP"]) #add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    }
    if (length(which(names(covariates) == "PRCP:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$infectiousNum.week * x$PRCP * covariates["PRCP:infectiousNum.week"]) #add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    }
    
  }
  
  if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week:PRCP")) >= 1 | length(which(names(covariates) == "infectiousNum.week:pen_pos.avg:PRCP")) >= 1 | length(which(names(covariates) == "pen_pos.avg:PRCP:infectiousNum.week")) >= 1 | length(which(names(covariates) == "infectiousNum.week:PRCP:pen_pos.avg")) >= 1 | length(which(names(covariates) == "PRCP:infectiousNum.week:pen_pos.avg")) >= 1 | length(which(names(covariates) == "PRCP:pen-pos.avg:infectiousNum.week")) >= 1){ # if the model includes the pen_pos.avg:infectiousNum.week covariate, we add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    
    if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:infectiousNum.week:PRCP"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "infectiousNum.week:pen_pos.avg:PRCP")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:pen_pos.avg:PRCP"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
    if (length(which(names(covariates) == "pen_pos.avg:PRCP:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:PRCP:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "infectiousNum.week:PRCP:pen_pos.avg")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:PRCP:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
    if (length(which(names(covariates) == "PRCP:pen_pos.avg:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["PRCP:pen_pos.avg:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "PRCP:infectiousNum.week:pen_pos.avg")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["PRCP:infectiousNum.week:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
  }
  
  if (length(which(names(covariates) == "contacts.avg:social")) >= 1 | length(which(names(covariates) == "social:contacts.avg")) >= 1){ # if the model includes the contacts.avg:social covariate, we add the product of the coefficient and contacts.avg:social values to lambda.
    
    if (length(which(names(covariates) == "contacts.avg:social")) >= 1){
      x$lambda <- x$lambda + (x$contacts.avg * x$social * covariates["contacts.avg:social"]) #add the product of the coefficient and contacts.avg:social values to lambda.
    }
    if (length(which(names(covariates) == "social:contacts.avg")) >= 1){
      x$lambda <- x$lambda + (x$contacts.avg * x$social * covariates["social:contacts.avg"]) #add the product of the coefficient and contacts.avg:social values to lambda.
    }
    
  }
  
  x$lambda <- exp(x$lambda) #finally, we exponentiate as we should
  
  x.initial <- droplevels(x[which(x$id_inf%in%innocCalves),]) #only include the initially-innoculated calves
  
  return(mean(x.initial$lambda))
  
}

lambdaEst.week <- function(x, model){  #calculate the mean per-capita lambda (i.e., force of infection) from infectious individuals each week.
  
  covariates <- model$coefficients #pull the covariates included in the model
  x$lambda <- covariates["(Intercept)"] #add the intercept value to driving infection force rate (i.e., lambda)
  
  #now we add to the lambda values depending on what covariates were included in the model.
  
  if (length(which(names(covariates) == "pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg covariate, we add the product of the coefficient and pen_pos.avg values to lambda.
    
    x$lambda <- x$lambda + (x$pen_pos.avg * covariates["pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg values to lambda.
    
  }
  
  if (length(which(names(covariates) == "infectiousNum.week")) >= 1){ # if the model includes the infectiousNum.week covariate, we add the product of the coefficient and infectiousNum.week values to lambda.
    
    x$lambda <- x$lambda + (x$infectiousNum.week * covariates["infectiousNum.week"]) #add the product of the coefficient and infectiousNum.week values to lambda.
    
  }
  
  if (length(which(names(covariates) == "PRCP")) >= 1){ # if the model includes the PRCP covariate, we add the product of the coefficient and PRCP values to lambda.
    
    x$lambda <- x$lambda + (x$PRCP * covariates["PRCP"]) #add the product of the coefficient and PRCP values to lambda.
    
  }
  
  if (length(which(names(covariates) == "contacts.avg")) >= 1){ # if the model includes the contacts.avg covariate, we add the product of the coefficient and contacts.avg values to lambda.
    
    x$lambda <- x$lambda + (x$contacts.avg * covariates["contacts.avg"]) #add the product of the coefficient and contacts.avg values to lambda.
    
  }
  
  if (length(which(names(covariates) == "social")) >= 1){ # if the model includes the social covariate, we add the product of the coefficient and social values to lambda.
    
    x$lambda <- x$lambda + (x$social * covariates["social"]) #add the product of the coefficient and social values to lambda.
    
  }
  
  if (length(which(names(covariates) == "socialDeg.to")) >= 1){ # if the model includes the socialDeg.to covariate, we add the product of the coefficient and socialDeg.to values to lambda.
    
    x$lambda <- x$lambda + (x$socialDeg.to * covariates["socialDeg.to"]) #add the product of the coefficient and socialDeg.to values to lambda.
    
  }
  
  if (length(which(names(covariates) == "socialDeg.from")) >= 1){ # if the model includes the socialDeg.from covariate, we add the product of the coefficient and socialDeg.from values to lambda.
    
    x$lambda <- x$lambda + (x$socialDeg.from * covariates["socialDeg.from"]) #add the product of the coefficient and socialDeg.from values to lambda.
    
  }
  
  #now we add the interaction term effects
  
  if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week")) >= 1 | length(which(names(covariates) == "infectiousNum.week:pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg:infectiousNum.week covariate, we add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    
    if(length(which(names(covariates) == "pen_pos.avg:infectiousNum.week")) >= 1){
       x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    if(length(which(names(covariates) == "infectiousNum.week:pen_pos.avg")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
  }
  
  if (length(which(names(covariates) == "pen_pos.avg:PRCP")) >= 1 | length(which(names(covariates) == "PRCP:pen_pos.avg")) >= 1){ # if the model includes the pen_pos.avg:PRCP covariate, we add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    
    if (length(which(names(covariates) == "pen_pos.avg:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$PRCP * covariates["pen_pos.avg:PRCP"]) #add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    }
    if (length(which(names(covariates) == "PRCP:pen_pos.avg")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$PRCP * covariates["PRCP:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:PRCP values to lambda.
    }
    
  }
  
  if (length(which(names(covariates) == "infectiousNum.week:PRCP")) >= 1 | length(which(names(covariates) == "PRCP:infectiousNum.week")) >= 1){ # if the model includes the infectiousNum.week:PRCP covariate, we add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    
    if (length(which(names(covariates) == "infectiousNum.week:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$infectiousNum.week * x$PRCP * covariates["infectiousNum.week:PRCP"]) #add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    }
    if (length(which(names(covariates) == "PRCP:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$infectiousNum.week * x$PRCP * covariates["PRCP:infectiousNum.week"]) #add the product of the coefficient and infectiousNum.week:PRCP values to lambda.
    }
    
  }
  
  if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week:PRCP")) >= 1 | length(which(names(covariates) == "infectiousNum.week:pen_pos.avg:PRCP")) >= 1 | length(which(names(covariates) == "pen_pos.avg:PRCP:infectiousNum.week")) >= 1 | length(which(names(covariates) == "infectiousNum.week:PRCP:pen_pos.avg")) >= 1 | length(which(names(covariates) == "PRCP:infectiousNum.week:pen_pos.avg")) >= 1 | length(which(names(covariates) == "PRCP:pen-pos.avg:infectiousNum.week")) >= 1){ # if the model includes the pen_pos.avg:infectiousNum.week covariate, we add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    
    if (length(which(names(covariates) == "pen_pos.avg:infectiousNum.week:PRCP")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:infectiousNum.week:PRCP"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "infectiousNum.week:pen_pos.avg:PRCP")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:pen_pos.avg:PRCP"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
    if (length(which(names(covariates) == "pen_pos.avg:PRCP:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["pen_pos.avg:PRCP:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "infectiousNum.week:PRCP:pen_pos.avg")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["infectiousNum.week:PRCP:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
    if (length(which(names(covariates) == "PRCP:pen_pos.avg:infectiousNum.week")) >= 1){
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["PRCP:pen_pos.avg:infectiousNum.week"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
    }
    
    if(length(which(names(covariates) == "PRCP:infectiousNum.week:pen_pos.avg")) >= 1 ){
      
      x$lambda <- x$lambda + (x$pen_pos.avg * x$infectiousNum.week * covariates["PRCP:infectiousNum.week:pen_pos.avg"]) #add the product of the coefficient and pen_pos.avg:infectiousNum.week values to lambda.
      
    }
    
  }
  
  if (length(which(names(covariates) == "contacts.avg:social")) >= 1 | length(which(names(covariates) == "social:contacts.avg")) >= 1){ # if the model includes the contacts.avg:social covariate, we add the product of the coefficient and contacts.avg:social values to lambda.
    
    if (length(which(names(covariates) == "contacts.avg:social")) >= 1){
      x$lambda <- x$lambda + (x$contacts.avg * x$social * covariates["contacts.avg:social"]) #add the product of the coefficient and contacts.avg:social values to lambda.
    }
    if (length(which(names(covariates) == "social:contacts.avg")) >= 1){
      x$lambda <- x$lambda + (x$contacts.avg * x$social * covariates["social:contacts.avg"]) #add the product of the coefficient and contacts.avg:social values to lambda.
    }
    
  }
  
  x$lambda <- exp(x$lambda) #finally, we exponentiate as we should
  perCapita.mean <- aggregate(lambda ~ id_sus + week, data = x, FUN = "mean") #calculate the per-capita average hazard that individuals will be colonized each week.
  
  perCapita.mean$count <- 1 #add a count column that will be used to calculate the number of people each week
  
  perCapita.susCount <- aggregate(count ~ week, data = perCapita.mean, FUN = "sum") #calculate the number of susceptible individuals each week.
  
  avgPerCapMean <- aggregate(lambda ~ week, data = perCapita.mean, FUN = "mean") # take the mean value of the per-capita range
  
  sdPerCepMean <- aggregate(lambda ~ week, data = perCapita.mean, FUN = "sd") # take the standard deviation value of the per-capita range
  
  outFrame <- data.frame(week = avgPerCapMean$week, avg_perCapita.mean = avgPerCapMean$lambda, avg_perCapita.sd = sdPerCepMean$lambda, avg_perCapita.se = (sdPerCepMean$lambda / sqrt(perCapita.susCount$count))) #create the output data frame containing average per-capita mean hazard, sd, and se 
  
  return(outFrame)
  
}

#2017
#{
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ 1,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "NULL")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { #NM problem
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
#   { 
#   test<-transtat::transreg(
#     formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg*social,
#     sus = "id_sus",
#     data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
#     dist = "weibull",
#     xdist = NULL,
#     optim_method = "Nelder-Mead"
#   )
   model.vec <- c(model.vec, "pen_pos.avg + contacts X social")
#   aic.vec <- c(aic.vec,  AIC(test))
   aic.vec <- c(aic.vec,  NA)
#   lik.vec <- c(lik.vec, test$loglik)
   lik.vec <- c(lik.vec, NA)
   distribution.vec <- c(distribution.vec, "weibull")
   year.vec <- c(year.vec,  2017) lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
# }

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
#   { 
#   test<-transtat::transreg(
#     formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social,
#     sus = "id_sus",
#     data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
#     dist = "weibull",
#     xdist = NULL,
#     optim_method = "Nelder-Mead"
#   )
   model.vec <- c(model.vec, "infectious_week X precip + social")
#   aic.vec <- c(aic.vec,  AIC(test))
   aic.vec <- c(aic.vec,  NA)
#   lik.vec <- c(lik.vec, test$loglik)
   lik.vec <- c(lik.vec, NA)
   distribution.vec <- c(distribution.vec, "weibull")
   year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
# } 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP  + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { #NM problem
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  


  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}    
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
#   { 
#   test<-transtat::transreg(
#     formula = Surv(start, stop, shedding) ~ pen_pos.avg+ contacts.avg*social + socialDeg.to,
#     sus = "id_sus",
#     data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
#     dist = "weibull",
#     xdist = NULL,
#     optim_method = "Nelder-Mead"
#   )
   model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_inf")
#   aic.vec <- c(aic.vec,  AIC(test))
   aic.vec <- c(aic.vec,  NA)
#   lik.vec <- c(lik.vec, test$loglik)
   lik.vec <- c(lik.vec, NA)
   distribution.vec <- c(distribution.vec, "weibull")
   year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
# }    
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg+ contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg+ contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg+ social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
 
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {#NM problem
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}    
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  #tier 5
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
#   {
#   test<-transtat::transreg(
#     formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social,
#     sus = "id_sus",
#     data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
#     dist = "weibull",
#     xdist = NULL,
#     optim_method = "Nelder-Mead"
#   )
   model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social")
#   aic.vec <- c(aic.vec,  AIC(test))
   aic.vec <- c(aic.vec,  NA)
#   lik.vec <- c(lik.vec, test$loglik)
   lik.vec <- c(lik.vec, NA)
   distribution.vec <- c(distribution.vec, "weibull")
   year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
# }

  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}    
  
    
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}    
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
#   { 
#   test<-transtat::transreg(
#     formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social + socialDeg.to + socialDeg.from,
#     sus = "id_sus",
#     data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
#     dist = "weibull",
#     xdist = NULL,
#     optim_method = "Nelder-Mead"
#   )
   model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social + popularity_inf + popularity_sus")
#   aic.vec <- c(aic.vec,  AIC(test))
   aic.vec <- c(aic.vec,  NA)
#   lik.vec <- c(lik.vec, test$loglik)
   lik.vec <- c(lik.vec, NA)
   distribution.vec <- c(distribution.vec, "weibull")
   year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
# }  

  { #problem (non-finite diff)
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts  + social + popularity_inf")
  #aic.vec <- c(aic.vec,  AIC(test))
  aic.vec <- c(aic.vec,  NA)
  #lik.vec <- c(lik.vec, test$loglik)
  lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts  + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts  + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts  + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
} 
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}   
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts  + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts  + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
    
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + social  + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + social  + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
    
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts + social  + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + contacts X social  + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
#   {
#   test<-transtat::transreg(
#     formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
#     sus = "id_sus",
#     data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
#     dist = "weibull",
#     xdist = NULL,
#     optim_method = "Nelder-Mead"
#   )
   model.vec <- c(model.vec, "infectious_week X precip + contacts X social + popularity_inf")
#   aic.vec <- c(aic.vec,  AIC(test))
   aic.vec <- c(aic.vec,  NA)
#   lik.vec <- c(lik.vec, test$loglik)
   lik.vec <- c(lik.vec, NA)
   distribution.vec <- c(distribution.vec, "weibull")
   year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
# }
 
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {#problem (exactly singular)
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  #tier 6
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
 test<-transtat::transreg(
   formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to,
   sus = "id_sus",
   data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
   dist = "weibull",
   xdist = NULL,
   optim_method = "Nelder-Mead"
 )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
   
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }

  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
   
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }

  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week +PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week +PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }

  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week + precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  #tier 7
  {
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }

#3-way interaction addition

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social ,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

#tier 4

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ #NM problem
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}
{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

#tier 5

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ #NM problem
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{

  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + socialDeg.from + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + popularity_sus + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social + socialDeg.from + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social + popularity_sus + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


#tier 6

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

#tier 7

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2017); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 1)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}





 #}

#2018

#{
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ 1,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "NULL")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  # { 
  #   test<-transtat::transreg(
  #     formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social,
  #     sus = "id_sus",
  #     data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
  #     dist = "weibull",
  #     xdist = NULL,
  #     optim_method = "Nelder-Mead"
  #   )
     model.vec <- c(model.vec, "pen_pos.avg + precip + social")
  #   aic.vec <- c(aic.vec,  AIC(test))
     aic.vec <- c(aic.vec,  NA)
  #   lik.vec <- c(lik.vec, test$loglik)
     lik.vec <- c(lik.vec, NA)
     distribution.vec <- c(distribution.vec, "weibull")
     year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  # }
 
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP  + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg+ contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  { #problem (non-finite difference)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg+ contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg+ contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg+ social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  { #problem (exactly singular)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week+ PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "precip + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
   #tier 5
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + contacts + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + contacts + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg Xprecip + infectious_week X precip + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }    
  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts  + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts  + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts  + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts  + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }   
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts  + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts  + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + social  + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + social  + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts + social  + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + contacts X social  + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  } 
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  #tier 6
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social + popularity_inf")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {#problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week +PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week +PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week + precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  #tier 7
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week + precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { #problem (non-finite)
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  { 
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg + infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }
  
  {
    test<-transtat::transreg(
      formula = Surv(start, stop, shedding) ~ pen_pos.avg*PRCP + infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
      sus = "id_sus",
      data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
      dist = "weibull",
      xdist = NULL,
      optim_method = "Nelder-Mead"
    )
    model.vec <- c(model.vec, "pen_pos.avg X precip + infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
    aic.vec <- c(aic.vec,  AIC(test))
    #aic.vec <- c(aic.vec,  NA)
    lik.vec <- c(lik.vec, test$loglik)
    #lik.vec <- c(lik.vec, NA)
    distribution.vec <- c(distribution.vec, "weibull")
    year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
  }


#3-way interaction addition

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social ,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

#tier 4

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

#tier 5

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg*social,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts X social")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + socialDeg.from + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + popularity_sus + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + social + socialDeg.from + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + social + popularity_sus + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


#tier 6

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg*social + socialDeg.to,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts X social + popularity_inf")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}


{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

#tier 7

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg + social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts + social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week + PRCP + contacts.avg*social + socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week + precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}

{ 
  test<-transtat::transreg(
    formula = Surv(start, stop, shedding) ~ pen_pos.avg*infectiousNum.week*PRCP + contacts.avg*social+ socialDeg.to + socialDeg.from,
    sus = "id_sus",
    data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
    dist = "weibull",
    xdist = NULL,
    optim_method = "Nelder-Mead"
  )
  model.vec <- c(model.vec, "pen_pos.avg X infectious_week X precip + contacts X social + popularity_inf + popularity_sus")
  aic.vec <- c(aic.vec,  AIC(test))
  #aic.vec <- c(aic.vec,  NA)
  lik.vec <- c(lik.vec, test$loglik)
  #lik.vec <- c(lik.vec, NA)
  distribution.vec <- c(distribution.vec, "weibull")
  year.vec <- c(year.vec,  2018); lambda.init.vec <- c(lambda.init.vec, lambdaEst.init(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test, innocCalves =  innoc_frame$calf_id)); lambda.vec <- c(lambda.vec, lambdaEst(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test));  test.week <- lambdaEst.week(x = droplevels(subset(pairedFrame.merge, year_2017 == 0)), model = test); test.week$model <- model.vec[length(model.vec)]; test.week$year <- year.vec[length(year.vec)]; lambda.week <- data.frame(data.table::rbindlist(list(lambda.week, test.week)))
}




  
#}

```

##Generate the AIC data frame for easy sorting

```{r aicFrame}
lambda.vec[which(is.na(aic.vec) == TRUE)] <- NA
lambda.init.vec[which(is.na(aic.vec) == TRUE)] <- NA

#looks like of the 626 candidate models 8 failed to converge due to hessian singularity issues.

aicFrame <- data.frame(model = model.vec, year = year.vec, distr = "weibull", aic = aic.vec, lklhd = lik.vec, lambda = lambda.vec)
aicFrame <- aicFrame[order(aicFrame$aic),] #order the models by AIC value
rownames(aicFrame) <- seq(1:nrow(aicFrame))

aicFrame.2017 <- droplevels(subset(aicFrame, year == 2017)) #subset by year
aicFrame.2017$deltaAIC <- NA #create delta AIC column
for(i in 1:nrow(aicFrame.2017)){ #fill in the delta AIC values
  aicFrame.2017$deltaAIC[i] <- abs(diff(c(aicFrame.2017$aic[i], min(aicFrame.2017$aic, na.rm = TRUE)))) #calculate difference between observation i and the minimum value. 
}
aicFrame.2017$relLiklihood <- exp(-1 * (aicFrame.2017$deltaAIC)/2) #calculate the relative AIC likelihood
aicFrame.2017$aicWt <- aicFrame.2017$relLiklihood / sum(aicFrame.2017$relLiklihood, na.rm = TRUE) #calculate AIC weight
aicFrame.2017$relWeight <- aicFrame.2017$aicWt / aicFrame.2017$aicWt[match("NULL", aicFrame.2017$model)] #quantify the support for this model relative to the NULL.
aicFrame.2017$weightedLambda <- aicFrame.2017$aicWt * aicFrame.2017$lambda # multiply lambda by aic weight, so that we can use model averaging to estimate the force of infection (beta)
beta.2017 <- sum(aicFrame.2017$weightedLambda, na.rm = TRUE) #force of infection estimated through model averaging

aicFrame.2017$weightedLambda.init <- aicFrame.2017$aicWt * aicFrame.2017$lambda.init # multiply lambda by aic weight, so that we can use model averaging to estimate the force of infection (beta)
beta_init.2017 <- sum(aicFrame.2017$weightedLambda.init, na.rm = TRUE) #force of infection estimated through model averaging

aicFrame.2017 #report all aic values for 2017 models

aicFrame.2018 <- droplevels(subset(aicFrame, year == 2018)) #subset by year
aicFrame.2018$deltaAIC <- NA #create delta AIC column
for(i in 1:nrow(aicFrame.2018)){ #fill in the delta AIC values
  aicFrame.2018$deltaAIC[i] <- abs(diff(c(aicFrame.2018$aic[i], min(aicFrame.2018$aic, na.rm = TRUE)))) #calculate difference between observation i and the minimum value. 
}
aicFrame.2018$relLiklihood <- exp(-1 * (aicFrame.2018$deltaAIC)/2) #calculate the relative AIC likelihood
aicFrame.2018$aicWt <- aicFrame.2018$relLiklihood / sum(aicFrame.2018$relLiklihood, na.rm = TRUE) #calculate AIC weight
aicFrame.2018$relWeight <- aicFrame.2018$aicWt / aicFrame.2018$aicWt[match("NULL", aicFrame.2018$model)]#quantify the support for this model relative to the NULL.
aicFrame.2018$weightedLambda <- aicFrame.2018$aicWt * aicFrame.2018$lambda # multiply lambda by aic weight, so that we can use model averaging to estimate the force of infection (beta)
beta.2018 <- sum(aicFrame.2018$weightedLambda, na.rm = TRUE) #force of infection estimated through model averaging

aicFrame.2018$weightedLambda.init <- aicFrame.2018$aicWt * aicFrame.2018$lambda.init # multiply lambda by aic weight, so that we can use model averaging to estimate the force of infection (beta)
beta_init.2018 <- sum(aicFrame.2018$weightedLambda.init, na.rm = TRUE) #force of infection estimated through model averaging

aicFrame.2018 #report all aic values for 2018 models

lambda.week_2017 <- droplevels(subset(lambda.week, year == 2017)) #subset the lambda.week data frame by year
lambda.week_2017.merge <- merge(lambda.week_2017, aicFrame.2017, by = "model") #merge the weekly lambda estimates with aic info.
lambda.week_2017.merge$weightedperCapita.mean <- lambda.week_2017.merge$avg_perCapita.mean*lambda.week_2017.merge$aicWt #calculate the weekly weighted lambda 
lambda.week_2017.agg <- aggregate(weightedperCapita.mean~week, data = lambda.week_2017.merge, FUN = "sum") #sum the weights each week
lambda.week_2017.merge$weightedperCapita.se <- lambda.week_2017.merge$avg_perCapita.se*lambda.week_2017.merge$aicWt #calculate the weekly weighted lambda 
se.week_2017.agg <- aggregate(weightedperCapita.se~week, data = lambda.week_2017.merge, FUN = "sum") #sum the weights each week
lambda.week_2017.agg$weightedperCapita.se <- se.week_2017.agg$weightedperCapita.se
lambda.week_2017.agg$year <- 2017

lambda.week_2018 <- droplevels(subset(lambda.week, year == 2018)) #subset the lambda.week data frame by year
lambda.week_2018$week <- lambda.week_2018$week - 52 #reset the weeks to start from 1
lambda.week_2018.merge <- merge(lambda.week_2018, aicFrame.2018, by = "model") #merge the weekly lambda estimates with aic info.
lambda.week_2018.merge$weightedperCapita.mean <- lambda.week_2018.merge$avg_perCapita.mean*lambda.week_2018.merge$aicWt #calculate the weekly weighted lambda 
lambda.week_2018.agg <- aggregate(weightedperCapita.mean~week, data = lambda.week_2018.merge, FUN = "sum") #sum the weights each week
lambda.week_2018.merge$weightedperCapita.se <- lambda.week_2018.merge$avg_perCapita.se*lambda.week_2018.merge$aicWt #calculate the weekly weighted lambda 
se.week_2018.agg <- aggregate(weightedperCapita.se~week, data = lambda.week_2018.merge, FUN = "sum") #sum the weights each week
lambda.week_2018.agg$weightedperCapita.se <- se.week_2018.agg$weightedperCapita.se
lambda.week_2018.agg$year <- 2018

lambda.week.agg <- data.frame(data.table::rbindlist(list(lambda.week_2017.agg, lambda.week_2018.agg)))

ggplot(lambda.week.agg, aes(x=week, y= weightedperCapita.mean, color = as.character(year))) +
  guides(color=guide_legend(title= "")) +
  geom_line(size=1.4)+
  geom_point(size=3) +
  geom_text(aes(label=round(weightedperCapita.mean, digits = 3), angle = 45), position= position_dodge(width=0), hjust= -0.3, size = 4) +
  geom_errorbar(aes(ymin=weightedperCapita.mean-weightedperCapita.se, ymax=weightedperCapita.mean+weightedperCapita.se), width=.2,
                 position=position_dodge(0)) +
  ylab("Weighted mean hazard rate") +
  xlab("Time (weeks)") +
  ylim(0,1) +
  scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10)) +
  theme_classic() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 20),
    legend.spacing.x = unit(0.3, "cm"),
    #legend.spacing.y = unit(5, "cm"),
    axis.text.x=element_text(colour="black", size = 18),
    axis.text.y=element_text(colour="black", size = 18),
    legend.text = element_text(colour="black", size = 18),
    legend.key.size = unit(1, "cm"),
    axis.title.x = element_text(colour="black", size = 20,margin = margin(t = 20, r = 0, b = 0, l = 0)),
    axis.title.y = element_text(colour="black", size = 20, margin = margin(t = 0, r = 30, b = 0, l = 0)),
    text = element_text(size = 15),
    panel.background = element_rect(fill = "gray99"),
    panel.grid.major = element_line(size=1.2, colour = "white"),
    panel.grid.minor = element_line(size=1.2, colour = "white")
  )


```

So, it looks like of the 626 models we ran, 24 failed to converge (mostly due to hessian singularity issues, meaning that the input parameters are linear functions of each other with respect to our data set, or that one or more terms are completely useless for predicting the response variable: https://stats.stackexchange.com/questions/181515/what-does-hessian-is-singular-mean-in-sas-proc-nlin). This problem likely prevents estimation of the Weibull distribution's scale parameter, as switching to an exponential distribution solved the problem in almost all cases. However, models fit to an exponential distribution tended to have much higher AIC values than those fit to Weibull distributions. The vast majority of problem cases contained the "social" covariate. Luckily, we can still get a sense of the important covariates by comparing AIC values from the successful models.

##Best-fitting

```{r best fit}

#2017
{bestFitting_2017<-transtat::transreg( 
  formula = Surv(start, stop, shedding) ~ infectiousNum.week*PRCP,
  sus = "id_sus",
  data = droplevels(subset(pairedFrame.merge, year_2017 == 1)),
  dist = "weibull",
  xdist = NULL,
  optim_method = "Nelder-Mead"
)
}

#2018
{bestFitting_2018<-transtat::transreg( 
  formula = Surv(start, stop, shedding) ~ socialDeg.to + socialDeg.from,
  sus = "id_sus",
  data = droplevels(subset(pairedFrame.merge, year_2017 == 0)),
  dist = "weibull",
  xdist = NULL,
  optim_method = "Nelder-Mead"
)
}
```

##Ratio calculation

Kenah (2011) and the transtat::transreg help page explain that "accelerated failure time models are log-linear models for the rate parameter in the specified survival time distribution. Each coefficient can be interpreted as the log rate ratio for a one-unit increase in the corresponding covariate." Therefore to obtain the true estimated rate ratio from our best-fitting models we must exponentiate the coefficients they report. 

Below we exponentiate the coefficents and Wald 95% CIs reported by each yearly best-fitting model. Note that there's a bug in transtat::transreg that sometimes causes negative variances to be reported, and subsequently Wald CIs and p-values cannot be calculated. We include two functions here to correct this when necessary.

```{r ratios}

pvals.bugFix <- function(object){
  parm <- names(coef(object))
  se <- sqrt(abs(diag(object$var)[parm]))
  z1 <- abs(object$coefficients[parm]) / se
  pvals <- 2 * pnorm(-z1)
  pvals <- pvals[order(pvals, decreasing = TRUE)] #order so that the least significant covariates are shown first.
  #pvals.leastSignif <- pvals[-which(pvals < max(pvals))]
  return(pvals)
  #return(pvals.leastSignif)
}

CI.bugfix <- function(object, alpha = 0.05){
  parm <- names(coef(object))
  z <- qnorm(1 - alpha / 2)
  se <- sqrt(abs(diag(object$var)[parm]))
  
  lower <- object$coefficients[parm] - z * se
  upper <- object$coefficients[parm] + z * se
  output <- data.frame(X = parm, coef = object$coefficients, lwr2.5 = lower, uppr97.5 = upper)
  return(output)
}

bestFitting_2017.summ <- summary(bestFitting_2017)
bestFitting_2017.summ$table #see that NAs were produced and we need to calculate some of the p-values and CIs ourselves
pvals.bugFix(object = bestFitting_2017) #looks like all pvalues are effectively 0
bestFitting_2017_CI<-CI.bugfix(bestFitting_2017) #calculate 95% CI for each coefficient

bestFitting_2018.summ <- summary(bestFitting_2018)
bestFitting_2018.summ$table #see that no NAs were produced

#Finally, we exponentiate reported values to generate the predicted weekly hazard rate ratio for all covariates.
exp(bestFitting_2017_CI[,2:4]) # see that all covariates are significant (the 95% CI never crosses 1)
exp(bestFitting_2018.summ$table[,1:3]) # see that all covariates are significant (the 95% CI never crosses 1)

```

##Literature cited

Anderson, D.R. 2008. Model based inference in the life sciences: a primer on evidence, pp. 88-104. Springer Science + Business Media, New York, USA. 

Kenah, E. 2011. Contact intervals, survival analysis of epidemic data, and estimation of R0. *Biostatistics* 12(3):548-566. https://dx.doi.org/10.1093%2Fbiostatistics%2Fkxq068.

Kenah, E. 2019. Pairwise survival analysis of infectious disease transmission data. In Held, L., Hens, N., ONeil, P.D., & Wallinga, J. eds. Handbook of Infectious Disease Data Analysis, pp. 221-244. Chapman and Hall/CRC, New York, USA. 

National Oceanic and Atmospheric Administration (NOAA). 2020. National centers for environmental information: climate data online. https://www.ncdc.noaa.gov/cdo-web/. Last accessed 08/03/2020.

Sharker, Y., & Kenah, E. 2019. Pairwise accelerated failure time models for infectious disease transmission with external sources of infection. Pre-print at https://arxiv.org/abs/1901.04916.